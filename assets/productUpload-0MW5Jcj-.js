import{g as I,k as w,i as B}from"./api-DBChI_ES.js";import{F as k}from"./Footer-DnPTH6_A.js";/* empty css               */const L=document.getElementById("product-form"),f=document.getElementById("img-input"),i=document.getElementById("preview-img"),y=document.getElementById("upload-icon"),m=document.querySelectorAll(".shipping-btn"),S=document.getElementById("footer");new k(S);let s="PARCEL",u=!1,d=null;document.addEventListener("DOMContentLoaded",async()=>{d=new URLSearchParams(window.location.search).get("id"),d&&(u=!0,document.title="상품 수정 | HODU Seller",document.querySelector(".page-title").textContent="상품 수정",document.querySelector(".save-btn").textContent="수정하기",await D(d))});async function D(t){try{const e=await I(t),a=e.product_name||e.name,r=e.product_info||e.products_info||e.info;document.getElementById("product-name").value=a,document.getElementById("price").value=e.price,document.getElementById("shipping-fee").value=e.shipping_fee,document.getElementById("stock").value=e.stock,document.getElementById("product-info").value=r,s=e.shipping_method,m.forEach(c=>{c.dataset.method===s?c.classList.add("active"):c.classList.remove("active")}),e.image&&(i.src=e.image,i.style.display="block",y.style.display="none",document.querySelector(".img-placeholder").style.backgroundColor="transparent")}catch(e){console.error("상품 정보 로드 실패",e),alert("상품 정보를 불러오는 데 실패했습니다."),window.history.back()}}f.addEventListener("change",t=>{const e=t.target.files[0];if(e){const a=new FileReader;a.onload=r=>{i.src=r.target.result,i.style.display="block",y.style.display="none",document.querySelector(".img-placeholder").style.backgroundColor="transparent"},a.readAsDataURL(e)}});m.forEach(t=>{t.addEventListener("click",()=>{m.forEach(e=>e.classList.remove("active")),t.classList.add("active"),s=t.dataset.method})});L.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("product-name").value,a=document.getElementById("price").value,r=document.getElementById("shipping-fee").value,c=document.getElementById("stock").value,g=document.getElementById("product-info").value,l=f.files[0];if(!u&&!l)return alert("상품 이미지를 등록해주세요!");if(!e||!a||!r||!c||!g)return alert("모든 정보를 입력해주세요.");const n=new FormData;n.append("name",e),n.append("price",parseInt(a)),n.append("shipping_method",s),n.append("shipping_fee",parseInt(r)),n.append("stock",parseInt(c)),n.append("info",g),l&&n.append("image",l);try{let o;u?(o=await w(d,n),alert("상품이 성공적으로 수정되었습니다.")):(o=await B(n),alert("상품이 성공적으로 등록되었습니다.")),console.log("처리 성공:",o),window.location.href="/openMarket/src/pages/seller-center/index.html"}catch(o){if(console.error(o),o.data){const h=Object.entries(o.data).map(([v,p])=>{const E=Array.isArray(p)?p.join(", "):p;return`[${v}] ${E}`}).join(`
`);alert(`처리 실패:
${h}`)}else o.detail?alert(o.detail):alert("알 수 없는 오류가 발생했습니다. 다시 시도해주세요.")}});document.querySelector(".cancel-btn").addEventListener("click",()=>{confirm("작성 중인 내용이 사라집니다. 취소하시겠습니까?")&&window.history.back()});
