(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function a(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(t){if(t.ep)return;t.ep=!0;const s=a(t);fetch(t.href,s)}})();const u="https://api.wenivops.co.kr/services/open-market";async function o(e,r={}){const a=localStorage.getItem("token"),c={...r.headers};r.body instanceof FormData||(c["Content-Type"]="application/json"),a&&(c.Authorization=`Bearer ${a}`);try{let t=await fetch(`${u}${e}`,{...r,headers:c});if(t.status===401){const n=localStorage.getItem("refreshToken");if(n&&!e.includes("/accounts/token/refresh/"))try{console.log("ðŸ”„ í† í° ë§Œë£Œ. ë¦¬í”„ë ˆì‹œ í† í°ìœ¼ë¡œ ìž¬ë°œê¸‰ ì‹œë„...");const i=await fetch(`${u}/accounts/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:n})});if(i.ok){const d=(await i.json()).access;console.log("âœ… í† í° ìž¬ë°œê¸‰ ì„±ê³µ"),localStorage.setItem("token",d),c.Authorization=`Bearer ${d}`,t=await fetch(`${u}${e}`,{...r,headers:c})}else console.warn("âŒ ë¦¬í”„ë ˆì‹œ í† í° ë§Œë£Œ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ. ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬."),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userType"),window.location.href="/openMarket/src/pages/login/index.html"}catch(i){console.error("âŒ í† í° ê°±ì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ:",i)}else!e.includes("/accounts/token/refresh/")&&!e.includes("/accounts/login/")&&!e.includes("/accounts/validate-username/")&&(console.warn("âŒ ì¸ì¦ ì‹¤íŒ¨ (í† í° ì—†ìŒ). ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬."),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/openMarket/src/pages/login/index.html")}const s=t.status===204?{}:await t.json();if(!t.ok){const n=new Error("API_ERROR");throw n.status=t.status,n.data=s,n}return s}catch(t){throw console.error("API Fetch Error:",t),t}}const f=(e,r)=>o("/accounts/login/",{method:"POST",body:JSON.stringify({username:e,password:r})}),h=e=>o("/accounts/validate-username/",{method:"POST",body:JSON.stringify({username:e})}),m=e=>o("/accounts/seller/validate-registration-number/",{method:"POST",body:JSON.stringify({company_registration_number:e})}),g=(e,r)=>o(r==="SELLER"?"/accounts/seller/signup/":"/accounts/buyer/signup/",{method:"POST",body:JSON.stringify(e)}),p=e=>o(`/products/${e}/`),y=e=>o(`/products/?search=${encodeURIComponent(e)}`),S=()=>o("/cart/"),O=e=>o("/cart/",{method:"POST",body:JSON.stringify(e)}),P=(e,r)=>o(`/cart/${e}/`,{method:"PUT",body:JSON.stringify({quantity:r})}),T=e=>o(`/cart/${e}/`,{method:"DELETE"}),b=e=>o("/order/",{method:"POST",body:JSON.stringify(e)}),k=e=>o(`/${e}/products/`),w=e=>o("/products/",{method:"POST",body:e}),$=(e,r)=>o(`/products/${e}/`,{method:"PUT",body:r}),I=e=>o(`/products/${e}/`,{method:"DELETE"});export{m as a,S as b,h as c,O as d,T as e,k as f,p as g,I as h,w as i,g as j,$ as k,f as l,b as o,y as s,P as u};
